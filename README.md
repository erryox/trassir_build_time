# Замеры времени сборки TRASSIR
> **Note**  
> К сожалению данные замеры не показывают ускорение при использовании sccache в реальных условиях. Все замеры производились на компьютере с локальным кэшем. Это могло повлиять как в лучшую, так и в худшую сторону. Так как не было дополнительных накладных расходов при передаче файлов по сети, но при этом появились дополнительные расходы на дисковую систему.

### Сборка с нуля
| Режим сборки | Количество минут |
| - | - |
| Без sccache | 42:03 |
| sccache | 6:20 |

Время сборки с [sccache](https://github.com/mozilla/sccache) сократилась почти в 7 раз. В первую очередь это ускорение коснётся новых разработчиков, или тех разработчиков, которым по какой-то причине понадобилось пересобрать проект с нуля.

### Переключение с ветки недельной давности на свежий develop
| Режим сборки | Количество минут |
| - | - |
| Без sccache | 22:43 |
| sccache | 6:33 |

### Переключение обратно на ветку недельной давности
| Режим сборки | Количество минут |
| - | - |
| Без sccache | 22:34 |
| sccache | 6:23 |

Мы предполагаем, что кэш уже полностью сгенерирован. Если какие-то изменения попали в develop, вероятно, как минимум один раз кто-то из разработчиков собирал TRASSIR с этими изменениями локально.

На мой взгляд, переключение на свежий develop после работы в своей ветки, наиболее частый кейс, когда можно будет заметить эффект от использования sccache. В этом случае экономия составляет 16 минут, время сборки сократилось примерно в 3.5 раза.  
И в 7 раз, если учитывать переключение туда-обратно. При работе над несколькими задачами параллельно, такое переключение между ветками происходит намного чаще, чем можно было бы ожидать. Например, зачастую приходится переключиться на задачу, которая на данный момент находится в тестировании, чтобы поправить найденные замечания.

### Переключение между develop и веткой разработки с небольшими изменениями
| Режим сборки | Количество минут |
| - | - |
| Без sccache | 3:56 |
| sccache | 1:04 |

## buildcache
Так же был рассмотрен другой подобный инструмент - [buildcache](https://github.com/mbitsnbites/buildcache/tree/master). К сожалению, протестировать его при сборке TRASSIR мне не удалось, но судя по [бенчмарку](https://github.com/mbitsnbites/buildcache/blob/master/doc/benchmarks.md) он работает как минимум не медленнее. А скорее всего ускорение при использование buildcache окажется ещё заметнее, так как помимо кэширования результатов компиляции, он позволяет кэшировать бинарные файлы, результаты тестов и многое другое (при использовании sccache большую часть времени сборки занимает линковка и т.п.). Минусом этого решения является чуть более сложная интеграция с нашим проектом.
